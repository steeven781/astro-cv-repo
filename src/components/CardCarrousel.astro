---
import { Icon } from "astro-icon/components";
const { title, logos } = Astro.props;
---
<style>
  .carousel-container {
    overflow: hidden;
    width: 100%;
    position: relative;
  }

  .carousel-track {
    display: flex;
    will-change: transform;
    animation: scroll 30s linear infinite;
  }

  .carousel-container:hover .carousel-track {
    animation-play-state: paused;
  }

  @keyframes scroll {
    from { transform: translateX(0); }
    to { transform: translateX(-50%); }
  }

  .carousel-track img {
    height: 60px;
    width: auto;
    object-fit: contain;
    margin: 0 2rem;
    flex-shrink: 0;
    border-radius: 50%;
    transition: transform 0.3s ease;
  }

  .carousel-track img:hover {
    transform: scale(1.1);
  }
</style>

<div class="card card-compact card-bordered border-[oklch(var(--s))] w-full hover:shadow-lg transition-all my-4">
  <div class="card-body">
    <h1 class="uppercase card-title font-extrabold tracking-tighter md:text-2xl">{title}</h1>
    <div class="carousel-container mt-4">
      {Array.isArray(logos) && logos.length > 0 && (
        <div class="carousel-track">
          {[...logos, ...logos].map((logo, index) => (
            <img
              src={logo}
              alt={`Customer logo ${index + 1}`}
            />
          ))}
        </div>
      )}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const carousels = document.querySelectorAll('.carousel-track');

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          (entry.target as HTMLElement).style.animationPlayState = 'running';
        } else {
          (entry.target as HTMLElement).style.animationPlayState = 'paused';
        }
      });
    }, { threshold: 0.1 });

    carousels.forEach(carousel => {
      observer.observe(carousel);
    });
  });
</script>
